{
    "name": "Enforce-Resource-Tags-PD",
    "type": "Microsoft.Authorization/policyDefinitions",
    "apiVersion": "2021-06-01",
    "scope": null,
        "properties": {
        "displayName": "Resources must have mandatory tagging applied",
        "policyType": "Custom",
        "mode": "Indexed",
        "description": "Enforce mandatory 'Owner', 'Department', 'Project' and other tags on Resources",
        "metadata": {
            "version": "1.0.0",
            "category": "Tags"
        },
        "policyRule": {
            "if": {
                "anyof": [
                    {
                        "field": "[concat('tags[', parameters('owner'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('department'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('project'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('team'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('environment'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('originalrqco'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('managedbyterraform'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('createdby'), ']')]",
                        "exists": "false"
                    },
                    {
                        "field": "[concat('tags[', parameters('createdon'), ']')]",
                        "exists": "false"
                    }
                    ]
            },
            "then": {
                "effect": "deny"
            }
        },
            "parameters": {
                "owner": {
                    "type": "String",
                    "metadata": {
                        "displayName": "owner",
                        "description": "Specifies the Owner of the resource"
                    }
                },
                "department": {
                    "type": "String",
                    "metadata": {
                        "displayName": "department",
                        "description": "Specifies the Department that the resource belongs to"
                    }
                },
                "project": {
                    "type": "String",
                    "metadata": {
                        "displayName": "project",
                        "description": "Specifies the Project that the resource belongs to"
                    }
                },
                "team": {
                    "type": "String",
                    "metadata": {
                        "displayName": "team",
                        "description": "Specifies the Team that the resource belongs to"
                    }
                },
                "environment": {
                    "type": "String",
                    "metadata": {
                        "displayName": "environment",
                        "description": "Specifies the Environment that the resource belongs to"
                    }
                },
                "originalrqco": {
                    "type": "String",
                    "metadata": {
                        "displayName": "originalrqco",
                        "description": "Specifies the Original Request or Change Order that the resource belongs to"
                    }
                },
                "managedbyterraform": {
                    "type": "String",
                    "metadata": {
                        "displayName": "managedbyterraform",
                        "description": "Specifies if the resources is managed by Terraform"
                    }
                },
                "createdby": {
                    "type": "String",
                    "metadata": {
                        "displayName": "createdby",
                        "description": "Specifies who created the resource"
                    }
                },
                "createdon": {
                    "type": "String",
                    "metadata": {
                        "displayName": "createdon",
                        "description": "Specifies the created on date for the resource"
                    }
                }
            }
        }
    }